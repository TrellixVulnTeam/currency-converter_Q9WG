"use strict";function toFloat(e){let t=parseFloat(e);return parseFloat(t.toFixed(4))}function toInt(e){return parseInt(e.replace(/[^\d]/g,""))}function toFixed(e,t){let a=e/t;return a<=999?a.toFixed(4):Math.round(a)}function toLastWord(e){let t,a=e.split(" ");for(let e=0;e<a.length;++e)/\S/.test(a[e])&&(t=e);return console.log(a[t]),a[t]}let Requester={array:[],async Get(e){let t;return await fetch(e).then((e=>e.json())).then((e=>{t=e})),await t},Transducer:async e=>await JSON.parse(e),Builder(e){let t=new Date;document.querySelector("h1.header__text").innerHTML=`Курс валют от ЦБ РФ <br class="header__br"/> на ${t.getDate()}-${t.getMonth()+1}-${t.getFullYear()} г.`;let a=document.querySelector(".exchange-rates__tbody");document.querySelector(".exchange-rates__thead").insertAdjacentHTML("afterbegin",'<tr class="exchange-rates__tr" id="thead"/>');let r=document.querySelector("#thead");r.insertAdjacentHTML("beforeend",'<td class="exchange-rates__column_name" id="td0">код</td>'),r.insertAdjacentHTML("beforeend",'<td class="exchange-rates__column_name" id="td1">валюта</td>'),r.insertAdjacentHTML("beforeend",'<td class="exchange-rates__column_name" id="td2">Курс ₽</td>'),a.insertAdjacentHTML("beforeend",'<tr class="exchange-rates__tr exchange-rates__tr__control" id="control"/>'),document.querySelector(".exchange-rates__tr__control").insertAdjacentHTML("beforeend",'<td class="exchange-rates__cell exchange-rates_side exchange-rates__tr_left" id="td0"><div class="search"><input class="search__input" type="search" id="search-by-cod" name="search"></div></td>\n<td class="exchange-rates__cell exchange-rates_main exchange-rates__search" id="td1"><div class="search"><input class="search__input" type="search" id="search-by-name" name="search"></div>\n<td class="exchange-rates__cell exchange-rates_side exchange-rates__tr_right converter_big" id="td2"><div class="converter"><input class="converter__input" type="search" id="converter" name="converter"></div></td>');Object.keys(e).length;for(let t=0;t<Object.keys(e.amount).length;++t)if(null!==e.ckod[""+(t+7)]){let r=e.bkod[t+7];a.insertAdjacentHTML("beforeend",`<tr class="exchange-rates__tr exchange-rates__tr_hover" id="tr${t}"/>`);let n=document.querySelector("#tr"+t);n.insertAdjacentHTML("beforeend",`<td class="exchange-rates__cell exchange-rates_side exchange-rates__tr_left " id="td0"><span>${e.ckod[""+(t+7)]}</span> <div>${r}</div></td>`),n.insertAdjacentHTML("beforeend",`<td class="exchange-rates__cell exchange-rates_main" id="td1"><img class="exchange-rates__flag" src="" alt="${r}"><span class="exchange-rates__cell_country"></span><br/><span  class="exchange-rates__cell_currency">${e.name[""+(t+7)]}</span></td>`),n.insertAdjacentHTML("beforeend",`<td class="exchange-rates__cell exchange-rates_side exchange-rates__tr_right" id="td2">${toFixed(toFloat(e.course[""+(t+7)]),toInt(""+e.amount[""+(t+7)]))}</td>`)}},ExtensionBuilder(e,t){let a=document.querySelectorAll(".exchange-rates__tr_hover");for(let t=0;t<a.length;++t)for(let r=0;r<e.country.length;++r){if(e.country[r].alpha2===a[t].firstElementChild.querySelector("div").innerHTML.substring(0,2)){a[t].firstElementChild.nextElementSibling.querySelector(".exchange-rates__cell_country").innerHTML=e.country[r].name,a[t].firstElementChild.nextElementSibling.querySelector(".exchange-rates__flag").src=`/build/assets/icons/flags/${e.country[r].alpha2}.png`;break}r===e.country.length-1&&(a[t].firstElementChild.nextElementSibling.querySelector(".exchange-rates__cell_country").innerHTML=a[t].firstElementChild.nextElementSibling.querySelector(".exchange-rates__cell_currency").innerHTML)}}},Doings={imageDisplay(e,t,a){""!==e?t.classList.add(a+"_hide-icon"):t.classList.remove(a+"_hide-icon")},NewSearch(){document.querySelectorAll(".search").forEach((e=>{e.addEventListener("input",(()=>{let t=e.querySelector("input").value;this.imageDisplay(t,e,"search");let a=document.querySelectorAll(".exchange-rates__tr_hover"),r=e.parentElement.id;for(let e=0;e<a.length;++e){let n="td1"===r?"td2":"td1";-1===a[e].querySelector("#"+r).innerHTML.toLowerCase().indexOf(""+t.toLowerCase())?!1===a[e].classList.contains("exchange-rates__tr_hide")&&!1===a[e].classList.contains(""+n)&&!1===a[e].classList.contains("td2")&&(a[e].classList.add("exchange-rates__tr_hide"),a[e].classList.add(""+r)):!0===a[e].classList.contains("exchange-rates__tr_hide")&&!0===a[e].classList.contains(""+r)&&(a[e].classList.remove("exchange-rates__tr_hide"),a[e].classList.remove(""+r))}}))}))},NewConverter(){document.querySelectorAll(".converter").forEach((e=>{e.addEventListener("input",(()=>{let t=e.querySelector("input").value;this.imageDisplay(t,e,"converter");let a=document.querySelectorAll(".exchange-rates__tr_hover"),r=e.parentElement.id;for(let e=0;e<a.length;++e){toFloat(a[e].querySelector("#"+r).innerHTML)>toInt(t)&&!1===a[e].classList.contains("td0")&&!1===a[e].classList.contains("td1")?(a[e].classList.add("exchange-rates__tr_hide"),a[e].classList.add("td2")):!0===a[e].classList.contains(""+r)&&(a[e].classList.remove("exchange-rates__tr_hide"),a[e].classList.remove("td2"))}}))}))}};async function Main(){let e=await Requester.Transducer(await Requester.Get("http://192.168.0.106/build/php/base/table.json"));await Requester.Builder(e);let t=await Requester.Get("http://192.168.0.106/build/php/base/codename.json");await Requester.ExtensionBuilder(t,e),await Doings.NewSearch(),await Doings.NewConverter()}Main();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJ0b0Zsb2F0IiwidmFsdWUiLCJmVmFsdWUiLCJwYXJzZUZsb2F0IiwidG9GaXhlZCIsInRvSW50IiwicGFyc2VJbnQiLCJyZXBsYWNlIiwidmFsdWUxIiwidmFsdWUyIiwibmV3VmFsdWUiLCJNYXRoIiwicm91bmQiLCJ0b0xhc3RXb3JkIiwic3RyaW5nIiwid29yZCIsImxhc3RXb3JkIiwic3BsaXQiLCJpIiwibGVuZ3RoIiwidGVzdCIsImNvbnNvbGUiLCJsb2ciLCJSZXF1ZXN0ZXIiLCJhcnJheSIsIltvYmplY3QgT2JqZWN0XSIsImRhdCIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsImRhdGEiLCJUcmFuc2R1Y2VyIiwiSlNPTiIsInBhcnNlIiwiRGF0YSIsIkRhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpbm5lckhUTUwiLCJnZXREYXRlIiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsImV4Y2hhbmdlIiwiaW5zZXJ0QWRqYWNlbnRIVE1MIiwibmFtZUl0ZW0iLCJPYmplY3QiLCJrZXlzIiwiYW1vdW50IiwiY2tvZCIsImJrb2QiLCJjdXJyZW50SXRlbSIsIm5hbWUiLCJjb3Vyc2UiLCJnZXQiLCJnZXQyIiwiZnVsbCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpaSIsImNvdW50cnkiLCJhbHBoYTIiLCJmaXJzdEVsZW1lbnRDaGlsZCIsInN1YnN0cmluZyIsIm5leHRFbGVtZW50U2libGluZyIsInNyYyIsIkRvaW5ncyIsInNlYXJjaCIsInRleHQiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRoaXMiLCJpbWFnZURpc3BsYXkiLCJwYXJlbnRJZCIsInBhcmVudEVsZW1lbnQiLCJpZCIsInRkIiwidG9Mb3dlckNhc2UiLCJpbmRleE9mIiwiY29udGFpbnMiLCJjb252ZXJ0ZXIiLCJhc3luYyIsIk1haW4iLCJHZXQiLCJCdWls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T0FBT3dCLGVBUmZMIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHRvRmxvYXQodmFsdWUpXG57XG4gICAgbGV0IGZWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgIHJldHVybiBwYXJzZUZsb2F0KGZWYWx1ZS50b0ZpeGVkKDQpKTtcbn1cblxuLyrQstC+0LfQstGA0LDRidCw0LXRgiDRgtC+0LvRjNC60L4g0YfQuNGB0LvQviDQuNC3INGB0YLRgNC+0LrQuCDQsiBJTlQqL1xuZnVuY3Rpb24gdG9JbnQodmFsdWUpXG57XG4gICAgcmV0dXJuIHBhcnNlSW50KHZhbHVlLnJlcGxhY2UoL1teXFxkXS9nLCAnJykpO1xufVxuXG5mdW5jdGlvbiB0b0ZpeGVkKHZhbHVlMSwgdmFsdWUyKVxue1xuICAgIGxldCBuZXdWYWx1ZSA9IHZhbHVlMSAvIHZhbHVlMlxuICAgIGlmKG5ld1ZhbHVlIDw9IDk5OSlcbiAgICB7XG4gICAgICAgIHJldHVybiBuZXdWYWx1ZS50b0ZpeGVkKDQpO1xuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChuZXdWYWx1ZSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiB0b0xhc3RXb3JkKHN0cmluZylcbntcbiAgICBsZXQgbGFzdFdvcmQgPSBzdHJpbmcuc3BsaXQoXCIgXCIpO1xuICAgIC8vIHJldHVybiBsYXN0V29yZFtsYXN0V29yZC5sZW5ndGgtMV07XG4gICAgbGV0IHdvcmQ7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXN0V29yZC5sZW5ndGg7ICsraSlcbiAgICB7XG4gICAgICAgIGlmKC9cXFMvLnRlc3QobGFzdFdvcmRbaV0pKVxuICAgICAgICB7XG4gICAgICAgICAgICB3b3JkID0gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zb2xlLmxvZyhsYXN0V29yZFt3b3JkXSk7XG4gICAgcmV0dXJuIGxhc3RXb3JkW3dvcmRdO1xuXG59XG5cbmxldCBSZXF1ZXN0ZXIgPVxue1xuICAgIGFycmF5OiBbXSxcbiAgICBhc3luYyBHZXQoc3RyaW5nKVxuICAgIHtcbiAgICAgICAgbGV0IGRhdDtcbiAgICAgICAgYXdhaXQgZmV0Y2goc3RyaW5nKVxuICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZGF0ID0gZGF0YTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgZGF0YSAke3R5cGVvZihkYXRhKX1gKTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgZGF0ICR7dHlwZW9mKGRhdCl9YCk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IGRhdDtcbiAgICB9LFxuICAgIGFzeW5jIFRyYW5zZHVjZXIoZGF0KVxuICAgIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IEpTT04ucGFyc2UoZGF0KTtcbiAgICB9LFxuICAgIEJ1aWxkZXIoZGF0KVxuICAgIHtcbiAgICAgICAgbGV0IERhdGEgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBsZXQgaGVhZFNwYW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaDEuaGVhZGVyX190ZXh0XCIpO1xuICAgICAgICBoZWFkU3Bhbi5pbm5lckhUTUwgPSBg0JrRg9GA0YEg0LLQsNC70Y7RgiDQvtGCINCm0JEg0KDQpCA8YnIgY2xhc3M9XCJoZWFkZXJfX2JyXCIvPiDQvdCwICR7RGF0YS5nZXREYXRlKCl9LSR7RGF0YS5nZXRNb250aCgpKzF9LSR7RGF0YS5nZXRGdWxsWWVhcigpfSDQsy5gO1xuXG4gICAgICAgIGxldCBleGNoYW5nZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZXhjaGFuZ2UtcmF0ZXNfX3Rib2R5XCIpO1xuICAgICAgICBsZXQgdGhlYWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmV4Y2hhbmdlLXJhdGVzX190aGVhZFwiKTtcbiAgICAgICAgdGhlYWQuaW5zZXJ0QWRqYWNlbnRIVE1MKCdhZnRlcmJlZ2luJyAsIGA8dHIgY2xhc3M9XCJleGNoYW5nZS1yYXRlc19fdHJcIiBpZD1cInRoZWFkXCIvPmApO1xuICAgICAgICBsZXQgbmFtZUl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjdGhlYWRgKTtcbiAgICAgICAgbmFtZUl0ZW0uaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnICxcbiAgICAgICAgICAgIGA8dGQgY2xhc3M9XCJleGNoYW5nZS1yYXRlc19fY29sdW1uX25hbWVcIiBpZD1cInRkMFwiPtC60L7QtDwvdGQ+YCk7XG4gICAgICAgIG5hbWVJdGVtLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJyAsXG4gICAgICAgICAgICBgPHRkIGNsYXNzPVwiZXhjaGFuZ2UtcmF0ZXNfX2NvbHVtbl9uYW1lXCIgaWQ9XCJ0ZDFcIj7QstCw0LvRjtGC0LA8L3RkPmApO1xuICAgICAgICBuYW1lSXRlbS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcgLFxuICAgICAgICAgICAgYDx0ZCBjbGFzcz1cImV4Y2hhbmdlLXJhdGVzX19jb2x1bW5fbmFtZVwiIGlkPVwidGQyXCI+0JrRg9GA0YEg4oK9PC90ZD5gKTtcblxuICAgICAgICBleGNoYW5nZS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsXG4gICAgICAgICAgICBgPHRyIGNsYXNzPVwiZXhjaGFuZ2UtcmF0ZXNfX3RyIGV4Y2hhbmdlLXJhdGVzX190cl9fY29udHJvbFwiIGlkPVwiY29udHJvbFwiLz5gKTtcbiAgICAgICAgbGV0IGNvbnRyb2wgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuZXhjaGFuZ2UtcmF0ZXNfX3RyX19jb250cm9sYCk7XG4gICAgICAgIGNvbnRyb2wuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLFxuICAgICAgICAgICAgYDx0ZCBjbGFzcz1cImV4Y2hhbmdlLXJhdGVzX19jZWxsIGV4Y2hhbmdlLXJhdGVzX3NpZGUgZXhjaGFuZ2UtcmF0ZXNfX3RyX2xlZnRcIiBpZD1cInRkMFwiPjxkaXYgY2xhc3M9XCJzZWFyY2hcIj48aW5wdXQgY2xhc3M9XCJzZWFyY2hfX2lucHV0XCIgdHlwZT1cInNlYXJjaFwiIGlkPVwic2VhcmNoLWJ5LWNvZFwiIG5hbWU9XCJzZWFyY2hcIj48L2Rpdj48L3RkPlxuPHRkIGNsYXNzPVwiZXhjaGFuZ2UtcmF0ZXNfX2NlbGwgZXhjaGFuZ2UtcmF0ZXNfbWFpbiBleGNoYW5nZS1yYXRlc19fc2VhcmNoXCIgaWQ9XCJ0ZDFcIj48ZGl2IGNsYXNzPVwic2VhcmNoXCI+PGlucHV0IGNsYXNzPVwic2VhcmNoX19pbnB1dFwiIHR5cGU9XCJzZWFyY2hcIiBpZD1cInNlYXJjaC1ieS1uYW1lXCIgbmFtZT1cInNlYXJjaFwiPjwvZGl2PlxuPHRkIGNsYXNzPVwiZXhjaGFuZ2UtcmF0ZXNfX2NlbGwgZXhjaGFuZ2UtcmF0ZXNfc2lkZSBleGNoYW5nZS1yYXRlc19fdHJfcmlnaHQgY29udmVydGVyX2JpZ1wiIGlkPVwidGQyXCI+PGRpdiBjbGFzcz1cImNvbnZlcnRlclwiPjxpbnB1dCBjbGFzcz1cImNvbnZlcnRlcl9faW5wdXRcIiB0eXBlPVwic2VhcmNoXCIgaWQ9XCJjb252ZXJ0ZXJcIiBuYW1lPVwiY29udmVydGVyXCI+PC9kaXY+PC90ZD5gKTtcblxuICAgICAgICBsZXQgYmlnU2l6ZUFycmF5ID0gT2JqZWN0LmtleXMoZGF0KS5sZW5ndGg7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgT2JqZWN0LmtleXMoZGF0LmFtb3VudCkubGVuZ3RoOyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmKGRhdC5ja29kW2Ake2kgKyA3fWBdICE9PSBudWxsKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxldCBia29kID0gZGF0LmJrb2RbaSArIDddO1xuICAgICAgICAgICAgZXhjaGFuZ2UuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLFxuICAgICAgICAgICAgICAgIGA8dHIgY2xhc3M9XCJleGNoYW5nZS1yYXRlc19fdHIgZXhjaGFuZ2UtcmF0ZXNfX3RyX2hvdmVyXCIgaWQ9XCJ0ciR7aX1cIi8+YCk7XG4gICAgICAgICAgICBsZXQgY3VycmVudEl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjdHIke2l9YCk7XG4gICAgICAgICAgICBjdXJyZW50SXRlbS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsXG4gICAgICAgICAgICAgICAgYDx0ZCBjbGFzcz1cImV4Y2hhbmdlLXJhdGVzX19jZWxsIGV4Y2hhbmdlLXJhdGVzX3NpZGUgZXhjaGFuZ2UtcmF0ZXNfX3RyX2xlZnQgXCIgaWQ9XCJ0ZDBcIj48c3Bhbj4ke2RhdC5ja29kW2Ake2kgKyA3fWBdfTwvc3Bhbj4gPGRpdj4ke2Jrb2R9PC9kaXY+PC90ZD5gKTtcbiAgICAgICAgICAgIGN1cnJlbnRJdGVtLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJyxcbiAgICAgICAgICAgICAgICBgPHRkIGNsYXNzPVwiZXhjaGFuZ2UtcmF0ZXNfX2NlbGwgZXhjaGFuZ2UtcmF0ZXNfbWFpblwiIGlkPVwidGQxXCI+PGltZyBjbGFzcz1cImV4Y2hhbmdlLXJhdGVzX19mbGFnXCIgc3JjPVwiXCIgYWx0PVwiJHtia29kfVwiPjxzcGFuIGNsYXNzPVwiZXhjaGFuZ2UtcmF0ZXNfX2NlbGxfY291bnRyeVwiPjwvc3Bhbj48YnIvPjxzcGFuICBjbGFzcz1cImV4Y2hhbmdlLXJhdGVzX19jZWxsX2N1cnJlbmN5XCI+JHtkYXQubmFtZVtgJHtpICsgN31gXX08L3NwYW4+PC90ZD5gKTtcbiAgICAgICAgICAgIGN1cnJlbnRJdGVtLmluc2VydEFkamFjZW50SFRNTCgnYmVmb3JlZW5kJyxcbiAgICAgICAgICAgICAgICBgPHRkIGNsYXNzPVwiZXhjaGFuZ2UtcmF0ZXNfX2NlbGwgZXhjaGFuZ2UtcmF0ZXNfc2lkZSBleGNoYW5nZS1yYXRlc19fdHJfcmlnaHRcIiBpZD1cInRkMlwiPiR7dG9GaXhlZCh0b0Zsb2F0KGRhdC5jb3Vyc2VbYCR7aSArIDd9YF0pLFxuICAgICAgICAgICAgICAgICAgICB0b0ludChgJHtkYXQuYW1vdW50W2Ake2kgKyA3fWBdfWApKX08L3RkPmApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcbiAgICBFeHRlbnNpb25CdWlsZGVyKGdldCwgZ2V0MilcbiAgICB7XG4gICAgICAgIGxldCBmdWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmV4Y2hhbmdlLXJhdGVzX190cl9ob3ZlcicpO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZ1bGwubGVuZ3RoOyArK2kpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvciAobGV0IGlpID0gMDsgaWkgPCBnZXQuY291bnRyeS5sZW5ndGg7ICsraWkpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYoZ2V0LmNvdW50cnlbaWldLmFscGhhMiA9PT0gKGZ1bGxbaV0uZmlyc3RFbGVtZW50Q2hpbGQucXVlcnlTZWxlY3RvcihgZGl2YCkuaW5uZXJIVE1MKS5zdWJzdHJpbmcoMCwyKSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGZ1bGxbaV0uZmlyc3RFbGVtZW50Q2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nLnF1ZXJ5U2VsZWN0b3IoYC5leGNoYW5nZS1yYXRlc19fY2VsbF9jb3VudHJ5YCkuaW5uZXJIVE1MID0gZ2V0LmNvdW50cnlbaWldLm5hbWU7XG4gICAgICAgICAgICAgICAgICAgIGZ1bGxbaV0uZmlyc3RFbGVtZW50Q2hpbGQubmV4dEVsZW1lbnRTaWJsaW5nLnF1ZXJ5U2VsZWN0b3IoYC5leGNoYW5nZS1yYXRlc19fZmxhZ2ApLnNyYyA9IGAvYnVpbGQvYXNzZXRzL2ljb25zL2ZsYWdzLyR7Z2V0LmNvdW50cnlbaWldLmFscGhhMn0ucG5nYDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYoaWkgPT09IGdldC5jb3VudHJ5Lmxlbmd0aC0xKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgZnVsbFtpXS5maXJzdEVsZW1lbnRDaGlsZC5uZXh0RWxlbWVudFNpYmxpbmcucXVlcnlTZWxlY3RvcihgLmV4Y2hhbmdlLXJhdGVzX19jZWxsX2NvdW50cnlgKS5pbm5lckhUTUwgPSBmdWxsW2ldLmZpcnN0RWxlbWVudENoaWxkLm5leHRFbGVtZW50U2libGluZy5xdWVyeVNlbGVjdG9yKGAuZXhjaGFuZ2UtcmF0ZXNfX2NlbGxfY3VycmVuY3lgKS5pbm5lckhUTUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5sZXQgRG9pbmdzID1cbntcbiAgICBpbWFnZURpc3BsYXkodmFsdWUsIHNlYXJjaCwgdGV4dClcbiAgICB7XG4gICAgICAgIGlmKHZhbHVlICE9PSBcIlwiKVxuICAgICAgICB7XG4gICAgICAgICAgICBzZWFyY2guY2xhc3NMaXN0LmFkZChgJHt0ZXh0fV9oaWRlLWljb25gKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIHNlYXJjaC5jbGFzc0xpc3QucmVtb3ZlKGAke3RleHR9X2hpZGUtaWNvbmApO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBOZXdTZWFyY2goKVxuICAgIHtcbiAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VhcmNoJykuZm9yRWFjaCgoc2VhcmNoKSA9PlxuICAgICAgIHtcbiAgICAgICAgICAgc2VhcmNoLmFkZEV2ZW50TGlzdGVuZXIoICdpbnB1dCcsICgpID0+XG4gICAgICAgICAgIHtcbiAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IHNlYXJjaC5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLnZhbHVlO1xuICAgICAgICAgICAgICAgdGhpcy5pbWFnZURpc3BsYXkodmFsdWUsIHNlYXJjaCwgXCJzZWFyY2hcIik7XG5cbiAgICAgICAgICAgICAgIGxldCBmdWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmV4Y2hhbmdlLXJhdGVzX190cl9ob3ZlcicpO1xuICAgICAgICAgICAgICAgbGV0IHBhcmVudElkID0gc2VhcmNoLnBhcmVudEVsZW1lbnQuaWQ7XG4gICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZ1bGwubGVuZ3RoOyArK2kpXG4gICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgbGV0IHRkID0gcGFyZW50SWQgPT09ICd0ZDEnID8gJ3RkMicgOiAndGQxJ1xuICAgICAgICAgICAgICAgICAgIGxldCBpbmRleE9mID0gZnVsbFtpXS5xdWVyeVNlbGVjdG9yKGAjJHtwYXJlbnRJZH1gKS5pbm5lckhUTUwudG9Mb3dlckNhc2UoKS5pbmRleE9mKGAke3ZhbHVlLnRvTG93ZXJDYXNlKCl9YCk7XG4gICAgICAgICAgICAgICAgICAgaWYoaW5kZXhPZiA9PT0gLTEpXG4gICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICBpZihmdWxsW2ldLmNsYXNzTGlzdC5jb250YWlucyhgZXhjaGFuZ2UtcmF0ZXNfX3RyX2hpZGVgKSA9PT0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGZ1bGxbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKGAke3RkfWApID09PSBmYWxzZSAmJiBmdWxsW2ldLmNsYXNzTGlzdC5jb250YWlucyhgdGQyYCkgPT09IGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsW2ldLmNsYXNzTGlzdC5hZGQoJ2V4Y2hhbmdlLXJhdGVzX190cl9oaWRlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsW2ldLmNsYXNzTGlzdC5hZGQoYCR7cGFyZW50SWR9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgaWYoZnVsbFtpXS5jbGFzc0xpc3QuY29udGFpbnMoYGV4Y2hhbmdlLXJhdGVzX190cl9oaWRlYCkgPT09IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGZ1bGxbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKGAke3BhcmVudElkfWApID09PSB0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2V4Y2hhbmdlLXJhdGVzX190cl9oaWRlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsW2ldLmNsYXNzTGlzdC5yZW1vdmUoYCR7cGFyZW50SWR9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICB9XG4gICAgICAgICAgIH0pO1xuICAgICAgIH0pO1xuICAgIH0sXG4gICAgTmV3Q29udmVydGVyKClcbiAgICB7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb252ZXJ0ZXInKS5mb3JFYWNoKChjb252ZXJ0ZXIpID0+XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnZlcnRlci5hZGRFdmVudExpc3RlbmVyKCAnaW5wdXQnLCAoKSA9PlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxldCB2YWx1ZSA9IGNvbnZlcnRlci5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLnZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VEaXNwbGF5KHZhbHVlLCBjb252ZXJ0ZXIsIFwiY29udmVydGVyXCIpO1xuXG4gICAgICAgICAgICAgICAgbGV0IGZ1bGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZXhjaGFuZ2UtcmF0ZXNfX3RyX2hvdmVyJyk7XG4gICAgICAgICAgICAgICAgbGV0IHBhcmVudElkID0gY29udmVydGVyLnBhcmVudEVsZW1lbnQuaWQ7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmdWxsLmxlbmd0aDsgKytpKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGZsb2F0ID0gdG9GbG9hdChmdWxsW2ldLnF1ZXJ5U2VsZWN0b3IoYCMke3BhcmVudElkfWApLmlubmVySFRNTCk7XG4gICAgICAgICAgICAgICAgICAgIGlmKGZsb2F0ID4gdG9JbnQodmFsdWUpICYmIGZ1bGxbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKGB0ZDBgKSA9PT0gZmFsc2UgJiYgZnVsbFtpXS5jbGFzc0xpc3QuY29udGFpbnMoYHRkMWApID09PSBmYWxzZSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFtpXS5jbGFzc0xpc3QuYWRkKCdleGNoYW5nZS1yYXRlc19fdHJfaGlkZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFtpXS5jbGFzc0xpc3QuYWRkKCd0ZDInKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmKGZ1bGxbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKGAke3BhcmVudElkfWApID09PSB0cnVlKVxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmdWxsW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2V4Y2hhbmdlLXJhdGVzX190cl9oaWRlJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmdWxsW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ3RkMicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG59XG5cbk1haW4oKTtcbmFzeW5jIGZ1bmN0aW9uIE1haW4oKVxue1xuICAgIGxldCBnZXQgPSBhd2FpdCBSZXF1ZXN0ZXIuVHJhbnNkdWNlcihhd2FpdCBSZXF1ZXN0ZXIuR2V0KCdodHRwOi8vMTkyLjE2OC4wLjEwNi9idWlsZC9waHAvYmFzZS90YWJsZS5qc29uJykpO1xuICAgIGF3YWl0IFJlcXVlc3Rlci5CdWlsZGVyKGdldCk7XG4gICAgbGV0IGdldDIgPSBhd2FpdCBSZXF1ZXN0ZXIuR2V0KCdodHRwOi8vMTkyLjE2OC4wLjEwNi9idWlsZC9waHAvYmFzZS9jb2RlbmFtZS5qc29uJyk7XG4gICAgYXdhaXQgUmVxdWVzdGVyLkV4dGVuc2lvbkJ1aWxkZXIoZ2V0MiwgZ2V0KTtcbiAgICBhd2FpdCBEb2luZ3MuTmV3U2VhcmNoKCk7XG4gICAgYXdhaXQgRG9pbmdzLk5ld0NvbnZlcnRlcigpO1xufVxuIl19
